<html>
<head>
<title>NGS Player Stats</title>
<script>/*<![CDATA[*/const defaultSeason=11;const minSeason=6;var season=defaultSeason;const version="2.3";var divisions=[];var included=new Set();var columnsOfInterest=["KDA","Takedowns","Kill Participation","Hero Damage","DPM","Damage Taken","Healing","HPM","Siege Damage","Team Fight Hero Damage","Team Fight Healing","Team Fight Damage Taken","XP Contribution","XPM","CC Time","Root Time","Silence Time","Stun Time","Time Dead","Time Dead %"];var increasing=["Time Dead","Time Dead %"];var percent=["Kill Participation","Time Dead %"];var time=["Time Dead","CC Time","Stun Time","Silence Time","Root Time"];var translation={"XPM":"XP per Minute","HPM":"Heaing per Minute","DPM":"Damage per Minute"};var rankThreshold=10;var gameThreshold=5;var divOrder=["Storm","Heroic","Nexus"];var tables={};for(var div of divisions){tables[div]=[];}
function updateConfiguration(){var configuration="";configuration+=gameThreshold+","+rankThreshold+",";for(var div of divisions){configuration+=(included.has(div)?"1":"0");}
localStorage.setItem('ngsstConfig'+season,configuration);return configuration;}
function loadLocalStorage(){var storageVersion=parseFloat(localStorage.getItem('ngsstVer'));if(isNaN(storageVersion)||(storageVersion!=null&&Math.floor(storageVersion)<Math.floor(version))){localStorage.setItem('ngsstVer',version);localStorage.setItem('ngsstConfig'+season,null);}
var configuration=localStorage.getItem('ngsstConfig'+season);if(configuration==null||configuration==undefined||configuration=="null"){included=new Set([divisions[0]]);configuration=updateConfiguration();}
var configData=configuration.split(",");gameThreshold=parseInt(configData[0]);rankThreshold=parseInt(configData[1]);var rankSlider=document.getElementById('rankRange');rankSlider.value=rankThreshold;updateThreshold('rank',true);var gameSlider=document.getElementById('gameRange');gameSlider.value=gameThreshold;updateThreshold('game',true);for(var divIndex=0;divIndex<configData[2].length;divIndex++){if(parseInt(configData[2].charAt(divIndex))==1){included.add(divisions[divIndex]);}}}
function generateTable(data,interest,increase,filters){var tableArea=document.getElementById("statsTables");var divElement=document.createElement("DIV");divElement.classList.add("statTable");var h3Element=document.createElement("H3");var interests=Object.keys(translation);if(interests.includes(interest)){h3Element.innerHTML=translation[interest]+" ("+interest+")";}else{h3Element.innerHTML=interest;}
divElement.appendChild(h3Element);var tableElement=document.createElement("TABLE");var theadElement=document.createElement("THEAD");var trElement=document.createElement("TR");var header=["Rank","Player",interest,"Games"];for(var column of header){var thElement=document.createElement("TH");thElement.innerHTML=column;trElement.appendChild(thElement);}
theadElement.append(trElement);var tbodyElement=document.createElement("TBODY");var colIndex=columnsOfInterest.indexOf(interest)+2;var valueDict={};for(var playerData of data){var player=playerData[0];var nGames=playerData[1];var value=parseFloat(playerData[colIndex]);if(!(value in valueDict)){valueDict[value]={'players':[],'games':[]};}
valueDict[value]['players'].push(player);valueDict[value]['games'].push(nGames);}
var allValues=Object.keys(valueDict);for(var index=0;index<allValues.length;index++){allValues[index]=parseFloat(allValues[index]);}
if(increase){allValues.sort(function(a,b){return a-b});}else{allValues.sort(function(a,b){return b-a});}
var count=1;for(var value of allValues){for(var index=0;index<valueDict[value]['players'].length;index++){var nGames=parseInt(valueDict[value]['games'][index]);if(nGames<gameThreshold){continue;}
var trElement=document.createElement("TR");var tdElement=document.createElement("TD");tdElement.innerHTML="#"+count;trElement.appendChild(tdElement);var tdElement=document.createElement("TD");var nameData=valueDict[value]['players'][index].split("#");var playerName=nameData[0];var blizzardID=nameData[1];var linkElement=document.createElement("A");linkElement.href="https://heroesprofile.com/Profile/?blizz_id="+blizzardID+"&battletag="+encodeURIComponent(playerName)+"&region=1";linkElement.target="_blank";linkElement.innerHTML=playerName;tdElement.appendChild(linkElement);trElement.appendChild(tdElement);var tdElement=document.createElement("TD");tdElement.classList.add("right");if(time.includes(interest)){var minutes=parseInt(value/60.0);var seconds=value%60.0;tdElement.innerHTML=minutes+":"+(seconds<10?"0":"")+seconds.toFixed(1);}else{if(percent.includes(interest)){tdElement.innerHTML=(100.0*value).toFixed(2)+"%";}else{tdElement.innerHTML=value.toFixed(2);}}
trElement.appendChild(tdElement);var tdElement=document.createElement("TD");tdElement.classList.add("right");tdElement.innerHTML=nGames;trElement.appendChild(tdElement);if(filters.length==0||filters.includes(playerName.toLowerCase())){tbodyElement.append(trElement);}
count++;if(count>rankThreshold){break;}}
if(count>rankThreshold){break;}}
tableElement.appendChild(theadElement);tableElement.appendChild(tbodyElement);divElement.appendChild(tableElement);if(count>0){tableArea.appendChild(divElement);}
return;}
function resetFilters(){document.getElementById("filter").value="";createTables();}
function createTables(){updateConfiguration();var filters=document.getElementById("filter").value.split(/[ \t]+/);var validFilters=[];for(var filter of filters){if(filter.length>=3&&filter.length<=12){validFilters.push(filter.toLowerCase());}}
var data=[];for(var div of included){if(data.length==0){console.log(tables[div]);data=Array.from(tables[div]);}else{data=data.concat(tables[div]);}}
var tableArea=document.getElementById("statsTables");while(tableArea.firstChild){tableArea.removeChild(tableArea.firstChild);}
if(data.length==0){var hElement=document.createElement("H2");hElement.innerHTML="You must select at least one division.";tableArea.appendChild(hElement);return;}
for(var column of columnsOfInterest){generateTable(data,column,increasing.includes(column),validFilters);}}
function processData(data){var lines=data.split("\n");var lastUpdated=document.getElementById("lastUpdate");lastUpdated.innerHTML+=lines[0];for(var index=2;index<lines.length;index++){var values=lines[index].split(',');if(values.length<10){continue;}
var div=values[1];values.splice(1,1);if(tables[div]==undefined){tables[div]=[];divisions.push(div);}
tables[div].push(values);}
divisions.sort(function(a,b){var aIndex=-1;var bINdex=-1;for(var index=0;index<divOrder.length;index++){var divPre=divOrder[index];if(a.startsWith(divPre)){aIndex=index;}
if(b.startsWith(divPre)){bIndex=index;}}
if(aIndex>=0&&bIndex>=0){return aIndex-bIndex;}
if(aIndex>=0){return-1;}
if(bIndex>=0){return 1;}
return(a<b?-1:1);});}
function toggle(div){var button=document.getElementById(div);if(included.has(div)){included.delete(div);button.classList.remove("tabOn");button.classList.add("tabOff");}else{included.add(div);button.classList.remove("tabOff");button.classList.add("tabOn");}
createTables();}
function updateThreshold(id,update){var rangeElement=document.getElementById(id+"Range");var newValue=rangeElement.value;var textElement=document.getElementById(id+"Threshold");textElements=textElement.innerHTML.split(":");textElement.innerHTML=textElements[0]+": "+newValue;if(id=='game'){gameThreshold=newValue;}else{rankThreshold=newValue;}
if(!update){createTables();}}
function handleEvent(e){var bytes=document.getElementById("loadingPercent");bytes.innerHTML=e.loaded+" bytes";if(e.type=="loadend"){bytes.innerHTML+="<p style='font-size:small'>Download complete!</p>";setTimeout(function(){processData(xhr.response);loadLocalStorage();loadButtons();createTables();var loading=document.getElementById("loading");loading.style.display="none";},500);}}
function loadData(){var url="https://raw.githubusercontent.com/patienc3v/patienc3v.github.io/master/ngs/data/season"+season+".csv";xhr.addEventListener('loadstart',handleEvent);xhr.addEventListener('load',handleEvent);xhr.addEventListener('loadend',handleEvent);xhr.addEventListener('progress',handleEvent);xhr.open("GET",url);xhr.send();}
var xhr=new XMLHttpRequest();;function initialize(){const queryString=window.location.search;const urlParams=new URLSearchParams(queryString);const seasonParam=urlParams.get('season');if(seasonParam!=null||seasonParam!=undefined){if(!isNaN(parseInt(seasonParam))){season=parseInt(seasonParam);}}
if(season>defaultSeason||season<minSeason){season=defaultSeason;}
document.getElementById('title').innerHTML+=" S"+season;var filterBox=document.getElementById("filter");filterBox.addEventListener("keyup",function(event){if(event.key==="Enter"){createTables();}});xhrAgent=loadData();}
function loadButtons(){var tabs=document.getElementById("tabs");var first=true;var divList=Object.keys(divisions);var tableElement=document.createElement("TABLE");var trElement=document.createElement("TR");for(var div of divisions){var tdElement=document.createElement("TD");var button=document.createElement("BUTTON");button.innerHTML="Div "+div;button.id=div;button.style.width="100%";tdElement.style.width=(100.0/divisions.length)+"%";if(included.has(div)){button.classList.add("tabOn");}else{button.classList.add("tabOff");}
button.setAttribute("onclick","javascript:toggle(\""+div+"\");");tdElement.appendChild(button);trElement.appendChild(tdElement);}
tableElement.appendChild(trElement);tabs.appendChild(tableElement);offset=document.getElementById('navbar').clientHeight;document.getElementById('stats').style.top=offset+"px";}
var offset=100;var prevScrollpos=window.pageYOffset;window.onscroll=function(){var currentScrollPos=window.pageYOffset;if(prevScrollpos>currentScrollPos){document.getElementById("navbar").style.top="0";}else{document.getElementById("navbar").style.top="-"+offset+"px";}
prevScrollpos=currentScrollPos;}/*]]>*/</script>
<style>#navbar{position:fixed;top:0;width:100%;transition:top .3s;z-index:5;background-color:#000;position:relative:top:0;left:0}#loading{width:100%;height:100%;z-index:10;background-color:#fff;text-align:center;position:absolute;left:0;top:0;float:left;color:#000;opacity:.75}#loadingProgress{margin:0;position:relative;top:50%;left:50%;font-size:30px;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}body{background-color:#2c3531;color:#fff;font-family:Sans-serif}.right{text-align:right}h3{background-color:#d1e8e2;color:#000;margin;10px;padding:10px;font-size:x-large;text-align:center}.statTable{width:calc(33.3% - 20px);float:left;margin:10px;padding:10px;background-color:#222;box-sizing:border-box}table{width:100%}thead{background-color:#116466;color:#fff;font-size:large}.padding{padding:10px}th{text-align:center;padding:10px}td{padding:10px}.title{font-size:xxx-large;color:#6283cb;margin:0;text-align:center;padding:10px 10px 0 10px;font-weight:bold;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}.tabOn{background-color:#6283cb;color:#000;padding:10px}.tabOff{background-color:#2c3531;color:#ccc;padding:10px}a{color:#fff}.footer{width:100%;position:fixed;left:0;bottom:0;color:#fff;color:#444;text-align:center;margin:0}#controls{float:right;text-align:right;margin-right:10px;padding-top:30px}#search{float:left;text-align:left;margin-left:10px;padding-top:30px}#searchBox{padding:5px;margin:10px}.sliderValue{padding:5px 0 5px 5px}.slider{height:15px;-webkit-appearance:none;background:#111;outline:0;border-radius:15px;overflow:hidden;box-shadow:inset 0 0 5px rgba(0,0,0,1);padding:5px}.slider::-webkit-slider-thumb{-webkit-appearance:none;width:15px;height:15px;border-radius:50%;background:#6283cb;cursor:pointer;border:4px solid #333}.dataSource{font-size:x-small;text-align:center;color:#ccc;padding:0}#stats{position:relative}</style>
</head>
<body onLoad="javascript:initialize()">
<div id="loading"><div id="loadingProgress">L O A D I N G<br><div id="loadingPercent">0 bytes</div><img src="Spin-1s-40px.png" alt="https://loading.io/spinner/spin/-spinner-ball-circle-rotate-rosary-loader-ajax"></div></div>
<div id="navbar">
<div id="search" class="padding">Search: <input id="filter" type="text" value="" class="padding"> <button class="tabOff" onclick="javascript:createTables()">Filter</button> <button class="tabOff" onclick="javascript:resetFilters()">Reset</button><p style="font-size:small">Only 3-12 character name(s) accepted. (Space separated)</p></div>
<div id="controls" class="padding">
<div class="sliderValue"><span class="sliderValue" id="gameThreshold">Min. # of Games: 5</span><input type="range" min="1" max="15" value="5" class="slider" id="gameRange" oninput="javascript:updateThreshold('game', true);" onmouseup="javascript:updateThreshold('game',false)"></div>
<div class="sliderValue"><span class="sliderValue" id="rankThreshold">Max Rank: 10</span><input type="range" min="10" max="100" value="10" class="slider" id="rankRange" step="5" oninput="javascript:updateThreshold('rank', true);" onmouseup="javascript:updateThreshold('rank',false)"></div>
</div>
<div class="title"><span id="title" onclick="javascript:window.open('https://www.nexusgamingseries.org/','_blank')">Nexus Gaming Series</span><br>
<span class="dataSource">Data compiled with <a href="https://ebshimizu.github.io/stats-of-the-storm/" target="_blank">Stats of the Storm</a> by <a href="http://falindrith.me/" target="_blank">Falindrith</a>.</span>
<span class="dataSource" id="lastUpdate">Last updated: </span>
</div>
<div class="tabs padding" id="tabs">
</div>
</div>
<div id="stats">
<div id="statsTables" class="padding">
</div>
</div>
<div class="footer padding">Copyright &copy; 2021 Patienc3. All Rights Reserved</div>
</body>
</html>