<html>
<head>
<title>NGS Match Schedule</title>
<script>/*<![CDATA[*/var season=11;var divisions=["Storm","Heroic","Nexus","A-East","A-West","B-Northeast","B-Southeast","B-West","C-East","C-West","D-East","D-West","E-East","E-West"];const version=2.0;var teamsToFollow=[];var teams={};var teamToggle={};var buffer=60;buffer*=60000;var data;var configuration;function loadLocalStorage(){var storageVersion=parseFloat(localStorage.getItem('ngssVer'));if(storageVersion==null||(storageVersion!=null&&Math.floor(storageVersion)<Math.floor(version))){localStorage.setItem('ngssVer',version);localStorage.setItem('ngssConfig'+season,null);}
configuration=localStorage.getItem('ngssConfig'+season);if(configuration==undefined||configuration=="null"){configuration="";for(var div of divisions){configuration+="0".repeat(teams[div].length)+",";}
configuration=configuration.substr(0,configuration.length-1);localStorage.setItem('ngssConfig'+season,configuration);}
var configData=configuration.split(',');var followText="";for(var divIndex=0;divIndex<configData.length;divIndex++){var divConfig=configData[divIndex];for(var index=0;index<divConfig.length;index++){teamToggle[divisions[divIndex]][teams[divisions[divIndex]][index]]=(divConfig[index]=="1");if(teamToggle[divisions[divIndex]][teams[divisions[divIndex]][index]]){teamsToFollow.push(teams[divisions[divIndex]][index]);console.log("Following "+teams[divisions[divIndex]][index]);if(teamsToFollow.length>1){followTeamText+="\t";}else{followTeamText="";}
followTeamText+=teamFollowButton(divIndex,teams[divisions[divIndex]][index]);}}}
if(teamsToFollow.length==0){followTeamText="No teams selected at the moment.";}
document.getElementById('followingTeams').innerHTML=followTeamText;}
function loadDivisions(index){var xhttp=new XMLHttpRequest();xhttp.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var option=document.createElement("option");option.text=divisions[index];document.getElementById('divSelect').add(option);var teamData=JSON.parse(xhttp.responseText)['returnObject']['teams'];teamData.sort();for(var idx=0;idx<teamData.length;idx++){teamData[idx]=teamData[idx].replace("'","");}
teams[divisions[index]]=teamData;teamToggle[divisions[index]]=[];for(var team of teamData){teamToggle[divisions[index]][team]=false;}
if(index==(divisions.length-1)){loadLocalStorage();loadFilter();loadSchedule();}else{loadDivisions(index+1);}}else{if(this.readyState==4)
alert("Error occurred while loading the teams for Division "+divisions[index]);}};xhttp.open("GET","https://www.nexusgamingseries.org/api/division/get?division="+divisions[index].toLowerCase(),true);xhttp.send();}
function loadFilter(){var index=document.getElementById("divSelect").selectedIndex;var div=divisions[index];teamsToDisplay=teams[div];filters="";for(var team of teamsToDisplay){console.log(team+" "+teamToggle[div][team]);if(teamToggle[div][team]){color="#4CAF50";}else{color="#f44336";}
filters+='<button class="filter" onClick=\"javascript:toggleTeam('+index+",\'"+team+'\');\" id="'+team+'" style="background-color:'+color+'">'+team+'</button>\n';}
document.getElementById("filters").innerHTML=filters;}
function teamFollowButton(index,team){var buttonText='<button class="filter" onclick="javascript:toggleTeam('+index+', \''+team+'\');">'+team+'</button>';return buttonText;}
function loadSchedule(){var xhttp=new XMLHttpRequest();xhttp.onreadystatechange=function(){if(this.readyState==4&&this.status==200){data=JSON.parse(xhttp.responseText)['returnObject'];document.getElementById('selector').style.display="block";document.getElementById('loading').style.display="none";process(data);}else{if(this.readyState==4)
alert("Error occurred while loading the schedule from the NGS website.");}};xhttp.open("GET","https://www.nexusgamingseries.org/api/schedule/get/matches/scheduled?season="+season,true);xhttp.send();}
function process(data){var today=Date.now();var teamID={};var matches={};for(var match of data){homeTeam=match['home']['teamName'];awayTeam=match['away']['teamName'];if(!(teamsToFollow.includes(homeTeam.replace("'",""))||teamsToFollow.includes(awayTeam.replace("'","")))){continue;}
if(teamID[homeTeam]==undefined){teamID[homeTeam]=match['home']['id'];}
if(teamID[awayTeam]==undefined){teamID[awayTeam]=match['away']['id'];}
matchTime=match['scheduledTime']['startTime'];if(matches[matchTime]==undefined){matches[matchTime]=[];}
matches[matchTime].push([homeTeam,awayTeam,match['matchId'],match['casterUrl']]);}
var times=Object.keys(matches);times.sort();var upcoming="";for(var time of times){if(time>=today-buffer){upcoming+="<table width='100%'>\n";upcoming+="<thead>\n";upcoming+="<tr><td class='padding' colspan='3'>"+timeConverter(time)+"</td></tr>\n";upcoming+="</thead>\n";upcoming+="<tbody>\n";for(var match of matches[time]){var home=match[0];var away=match[1];var id=match[2];var caster=match[3];upcoming+="<tr>\n";upcoming+='<td class="padding" width="50%"><a href="https://www.nexusgamingseries.org/teamProfile/'+home.replace(" ","_")+'">'+home+"</a>";upcoming+=" vs. ";upcoming+='<a href="https://www.nexusgamingseries.org/teamProfile/'+away.replace(" ","_")+'">'+away+"</a></td>";upcoming+='<td class="padding" width="15%"><a href="https://www.nexusgamingseries.org/match/view/'+id+'">Match Info</a></td>';if(caster==undefined||caster.length==0){upcoming+="<td class='padding'>No caster yet</td>";}else{urlSplit=caster.split("/");username=urlSplit[urlSplit.length-1];url='https://twitch.tv/'+username;upcoming+='<td class="padding"><a href="'+url+'">'+url+"</a></td>";}
upcoming+="</tr>\n"}
upcoming+="</table>\n"}}
if(upcoming.length>0){document.getElementById("upcomingMatches").innerHTML=upcoming;}else{document.getElementById("upcomingMatches").innerHTML="No upcoming matches scheduled yet.";}
var past="";for(var time of times){if(time>=today-buffer){break;}
past+="<table width='100%'>\n";past+="<thead>\n";past+="<tr><td class='padding' colspan='3'>"+timeConverter(time)+"</td></tr>\n";past+="</thead>\n";past+="<tbody>\n";for(var match of matches[time]){var home=match[0];var away=match[1];var id=match[2];var caster=match[3];past+="<tr>\n";past+='<td class="padding" width="50%"><a href="https://www.nexusgamingseries.org/teamProfile/'+home.replace(" ","_")+'">'+home+"</a>";past+=" vs. ";past+='<a href="https://www.nexusgamingseries.org/teamProfile/'+away.replace(" ","_")+'">'+away+"</a></td>";past+='<td class="padding" width="15%"><a href="https://www.nexusgamingseries.org/match/view/'+id+'">Match Info</a></td>';if(caster==undefined||caster.length==0){past+="<td class='padding'>Not casted</td>";}else{urlSplit=caster.split("/");username=urlSplit[urlSplit.length-1];url='https://twitch.tv/'+username;past+='<td class="padding"><a href="'+url+'">'+url+"</a></td>";}
past+="</tr>\n"}
past+="</table>\n"}
if(past.length>0){document.getElementById("pastMatches").innerHTML=past;}else{document.getElementById("pastMatches").innerHTML="No matches played yet.";}}
function toggleTeam(divIndex,team){teamToggle[divisions[divIndex]][team]=!teamToggle[divisions[divIndex]][team];var followTeamText=document.getElementById('followingTeams').innerHTML;if(teamToggle[divisions[divIndex]][team]){teamsToFollow.push(team);if(teamsToFollow.length>1){followTeamText+="\t";}else{followTeamText="";}
followTeamText+=teamFollowButton(divIndex,team);}else{for(var index=0;index<teamsToFollow.length;index++){if(teamsToFollow[index]==team){teamsToFollow.splice(index,1);break;}}
if(teamsToFollow.length==0){followTeamText="No teams selected at the moment.";}else{var followTeamTextData=followTeamText.split('\t');for(var index=0;index<followTeamTextData.length;index++){if(followTeamTextData[index].substring(followTeamTextData[index].length-team.length-9,followTeamTextData[index].length-9)==team){followTeamTextData.splice(index,1);break;}}
followTeamText="";for(var followTeam of followTeamTextData){followTeamText+=followTeam+"\t";}
followTeamText=followTeamText.substr(0,followTeamText.length-3);}}
document.getElementById('followingTeams').innerHTML=followTeamText;var divTeams=teams[divisions[divIndex]];var index=0;for(var t of divTeams){if(t==team){break;}
index++;}
var configData=configuration.split(',');configData[divIndex]=configData[divIndex].substr(0,index)+(teamToggle[divisions[divIndex]][team]?"1":"0")+configData[divIndex].substr(index+1,configData[divIndex].length);console.log(configData[divIndex]);configuration="";for(var divConfig of configData){configuration+=divConfig+",";}
configuration=configuration.substr(0,configuration.length-1);console.log(configuration);localStorage.setItem('ngssConfig'+season,configuration);var button=document.getElementById(team);if(button!=undefined){if(teamToggle[divisions[divIndex]][team]){button.style.backgroundColor="#4CAF50";}else{button.style.backgroundColor="#f44336";}}
process(data);}
function timeConverter(UNIX_timestamp){var a=new Date(parseFloat(UNIX_timestamp));var months=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];var year=a.getFullYear();var month=months[a.getMonth()];var date=a.getDate();var hour=a.getHours();var min=a.getMinutes();var sec=a.getSeconds();var zone=a.toLocaleTimeString('en-us',{timeZoneName:'short'}).split(' ')[2]
var time=month+' '+date+', '+year+' @ '+(''+hour).padStart(2,'0')+':'+(''+min).padStart(2,'0')+" "+zone;return time;}/*]]>*/</script>
<style>body{background-color:#18191b;color:#fff;font-family:Sans-serif}thead{background-color:#f2692e;color:#fff;font-size:large}.padding{padding:10px}.title{color:#f2692e;background-color:#fff;font-size:60px;width:100%;margin:0;height:100px;text-align:center;padding:10px 10px 0 10px;font-weight:bold;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}.schedule{color:#fff;background-color:#26282b;width:100%;margin:10px 0 10px 0;padding:10px 10px 0 10px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}.scheduletitle{font-size:42px;margin:10px}#followingTeams{text-align:center;margin:10px;width:100%}#upcomingMatches{margin:10px}#pastMatches{width:100%;margin:10px}#loading{width:100%;margin:10px}#followingTitle{width:100%;margin:10px;font-size:x-large}#selector{display:none}#divSelector{width:100%;text-align:center;padding:10px}#filters{text-align:center;padding:10px;width:100%}.filter{background-color:#4caf50;padding:10px}a{color:#fff}.footer{position:fixed;left:0;bottom:0;width:100%;background-color:#fff;color:#000;text-align:center;margin:0;padding:10px}</style>
</head>
<body onLoad="javascript:loadDivisions(0)">
<div class="title">Nexus Gaming Series</div>
<div id="loading">Loading . . .</div>
<div id="selector">
<div id="followingTitle">Choose Teams to Follow</div>
<div id="divSelector">Division: <select name="division" id="divSelect" onchange="javascript:loadFilter()"></select></div>
<div id="filters">Loading Teams for the Division</div>
<div id="followingTitle">Selected Teams</div>
<div id="followingTeams">Please wait..</div>
</div>
<div class="schedule">
<div class="scheduletitle">Upcoming Matches</div>
<div id="upcomingMatches">Please wait...</div>
<div class="scheduletitle">Past Matches</div>
<div id="pastMatches">Please wait...</div>
<p>&nbsp;</p>
</div>
<div class="footer">Copyright &copy; 2021 Patienc3. All Rights Reserved</div>
</body>
</html>