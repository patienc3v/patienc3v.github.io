<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="apple-touch-icon" sizes="180x180" href="images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="images/favicon/favicon-16x16.png">
  <link rel="manifest" href="images/favicon/site.webmanifest">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gen.M Esports News</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="styles/common.css">
  <link rel="stylesheet" href="styles/news.css">
</head>
<body>
  <nav>
    <img src="images/gen.m.png" alt="Gen.M Esports Logo">
    <span>Gen.M Esports</span>
    <div id="menu">
      <a href="index.html">Home</a>
      <a href="news.html">News</a>
      <a href="roster.html">Roster</a>
      <a href="stats.html">Statistics</a>
      <a href="schedule.html">Schedule</a>
      <a href="videos.html">Videos</a>
    </div>
    <a href="javascript:void(0);" class="icon" onclick="javascript:toggleMenu();">
    <i class="fa fa-bars"></i>
    </a>
  </nav>

  <main>
    <h2>Latest News</h2>
    <div class="news-list" id="newsList"></div>
    <div class="pagination" id="pagination"></div>
  </main>

  <footer>
    <p>&copy; 2025 Gen.M Esports. All rights reserved.</p>
  </footer>

  <script>
    let newsData = [];
    const menu = document.getElementById("menu");

    function toggleMenu() {
      if (menu.style.display === "block") {
        menu.style.display = "none";
      } else {
        menu.style.display = "block";
      }
    } 

    const newsPerPage = 10;
    let currentPage = 1;

    function renderNews() {
      const start = (currentPage - 1) * newsPerPage;
      const end = start + newsPerPage;
      const newsList = document.getElementById('newsList');
      newsList.innerHTML = '';

      newsData.slice(start, end).forEach((news, index) => {
        const isExpanded = currentPage === 1 && index === 0 ? 'expanded' : '';
        const item = document.createElement('div');
        item.className = `news-item ${isExpanded}`;
        item.innerHTML = `
          <div class="news-header">
            ${news.thumbnail ? `<img src="images/news/${news.thumbnail}" alt="Thumbnail" class="thumbnail">` : ''}
            <div>
              <div class="news-title">${news.title}</div>
              <div class="news-date">${news.date}</div>
            </div>
          </div>
          <div class="news-content">${news.content}</div>
        `;
        item.addEventListener('click', () => {
          document.querySelectorAll('.news-item').forEach(i => i.classList.remove('expanded'));
          item.classList.add('expanded');
        });
        newsList.appendChild(item);
      });
    }

    function renderPagination() {
      const totalPages = Math.ceil(newsData.length / newsPerPage);
      const pagination = document.getElementById('pagination');
      pagination.innerHTML = '';

      const createBtn = (label, page, disabled = false, active = false) => {
        const btn = document.createElement('button');
        btn.textContent = label;
        if (disabled) btn.disabled = true;
        if (active) btn.classList.add('active');
        btn.addEventListener('click', () => {
          currentPage = page;
          renderNews();
          renderPagination();
        });
        return btn;
      };

      pagination.appendChild(createBtn('First', 1, currentPage === 1));
      pagination.appendChild(createBtn('Prev', currentPage - 1, currentPage === 1));

      let startPage = Math.max(1, currentPage - 2);
      let endPage = Math.min(totalPages, startPage + 4);
      if (endPage - startPage < 4) startPage = Math.max(1, endPage - 4);

      for (let i = startPage; i <= endPage; i++) {
        pagination.appendChild(createBtn(i, i, false, i === currentPage));
      }

      pagination.appendChild(createBtn('Next', currentPage + 1, currentPage === totalPages));
      pagination.appendChild(createBtn('Last', totalPages, currentPage === totalPages));
    }

    async function fetchData() {      
      try {
        const response = await fetch("data/news.json");
        
        if (!response.ok) {
            throw new Error('Error while retrieving the team data.');
        }

        newsData = await response.json();
    } catch (error) {
        console.error('Failed to fetch news...', error);
      } finally {
        renderNews();
        renderPagination();
      }
    }

    fetchData();
  </script>
</body>
</html>
